2025-08-06 19:28

Status: #Finished 

Tags: [[cyber security]] [[fundamentals]] [[hack the box]] [[networking]] 


# ðŸ›¡ï¸ Proxies â€“ HTB Notes

---

## ðŸ§  What is a Proxy?

A **proxy** is a **mediator** device/service that sits **between a client and a destination**, intercepting and possibly altering or inspecting traffic.

> ðŸ“Œ Key difference: A **proxy inspects traffic** (Layer 7), while a **gateway** just routes traffic without inspection.

---

### ðŸ§© Different Perspectives on Proxies

| Group               | Usage Example                                             |
|---------------------|-----------------------------------------------------------|
| Security Experts    | BurpSuite, SOCKS/SSH Proxies (e.g., Chisel, sshuttle)     |
| Web Developers      | Cloudflare, ModSecurity for WAF & traffic filtering        |
| Average Users       | â€œHide IPâ€ â†’ Usually use **VPNs** (â‰  proxy)                |
| Law Enforcement     | Often link proxies with illegal/anonymous activity         |

> â˜ ï¸ Common Mistake: Thinking "proxy = IP change". Thatâ€™s **VPN behavior**, not necessarily proxy.

---

## ðŸ“š OSI Layer

Proxies almost always operate at **Layer 7 (Application Layer)** of the OSI Model.

---

## ðŸ§­ Types of Proxies

---

### ðŸ” 1. Forward Proxy (a.k.a Dedicated Proxy)

- The **classic type** of proxy people think of
- **Client** â†’ makes request to **proxy**, proxy forwards it to **target server**
- Used in **corporate environments**, **BurpSuite**, etc.

#### ðŸ› ï¸ Use Cases

- Restrict internet access in organizations
- Scan/filter outbound traffic for malware
- Modify or intercept requests (e.g., BurpSuite for pen testing)
- Act as **web filters**

#### ðŸ’¡ Technical Behavior

- Most browsers (Chrome, Edge) obey **system proxy settings**
- Firefox uses **libcurl** (ignores system proxy), malware must be proxy-aware to function properly
- DNS tunneling can bypass this but is detectable with logging (e.g., Sysmon)

#### ðŸ”Ž Example

- Malware â†’ Needs to use proxy-aware mechanisms to exfiltrate data
- HTTP request â†’ Goes through Burp â†’ Then to actual site

---

### ðŸ” 2. Reverse Proxy

- Proxy **in front of servers** to **handle inbound requests**
- **Internet client** â†’ **Reverse proxy** â†’ **Backend server**

#### ðŸ› ï¸ Use Cases

- **Protects internal web servers** from direct exposure
- Load balancing
- Caching/static content offloading
- **DDoS protection** (Cloudflare)
- Reverse tunneling for C2 (Command & Control)

#### ðŸ”¥ Tools/Examples

- **Cloudflare** â€“ WAF, DDoS mitigation
- **ModSecurity** â€“ WAF inspecting malicious payloads
- Reverse proxy via **SSH tunnel** for hiding attacker traffic

---

### ðŸ” 3. Transparent vs Non-Transparent Proxies

| Type             | Client Awareness | Config Needed | Use Case Example                             |
|------------------|------------------|---------------|-----------------------------------------------|
| Transparent      | âŒ No             | âŒ No         | ISP filtering, schools, cafes                 |
| Non-Transparent  | âœ… Yes            | âœ… Yes        | BurpSuite (manual proxy), org firewalls       |

- **Transparent Proxy**: Intercepts traffic **silently**
  - Client is **not configured**
  - Still performs inspection/modification
- **Non-Transparent Proxy**: Client **must know and be configured**
  - No access without config
  - Traffic explicitly routed via proxy

---

## ðŸ§µ Summary Table

| Proxy Type         | Direction      | Client Awareness | Layer | Common Tools        | Use Case                          |
|--------------------|----------------|------------------|-------|---------------------|-----------------------------------|
| Forward Proxy       | Outbound       | Optional          | 7     | BurpSuite, Squid     | Web filtering, monitoring         |
| Reverse Proxy       | Inbound        | No (client unaware)| 7     | Nginx, HAProxy, Cloudflare | Load balancing, DDOS protection  |
| Transparent Proxy   | Either         | No                | 7     | Squid, pfSense       | ISP traffic filtering             |
| Non-Transparent     | Either         | Yes               | 7     | Burp, Fiddler        | Explicit proxy use                |

---

## ðŸ•µï¸ Real-World Scenarios

- âœ… **Corporate Internet Access** â†’ Forward Proxy filters outgoing traffic
- âœ… **Cloudflare** â†’ Reverse Proxy shielding origin servers from attacks
- âœ… **C2 (Command & Control)** â†’ Reverse proxy over SSH to evade IDS
- âœ… **BurpSuite** â†’ Forward Proxy for inspecting/modifying HTTP traffic

---

## ðŸ§  Fun Fact

> Most malware isn't proxy-aware. If your organization uses Firefox (libcurl) and a web proxy, you **break most simple malware** out-of-the-box ðŸ§ ðŸ’¥

---

## References



